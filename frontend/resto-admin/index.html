<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Resto Admin</title>
  <style>body{font-family:Arial;margin:20px}label{display:block;margin-top:8px}textarea{width:100%;height:120px}</style>
</head>
<body>
  <h2>Restaurant Admin</h2>
  <label>API Key <input id="api_key" style="width:400px" /></label>

  <h3>System Instruction</h3>
  <label>Instruction<textarea id="instruction"></textarea></label>
  <button id="save-instruction">Save Instruction</button>
  <pre id="instr-out"></pre>

  <h3>Upload Menu</h3>
  <label>Menu Text<textarea id="menu_text" placeholder="Appetizers:\n- ..."></textarea></label>
  <button id="upload-menu">Upload Menu</button>
  <pre id="menu-out"></pre>

  <script>
    async function postJson(url, apiKey, body){
      const headers = {'Content-Type':'application/json'};
      if (apiKey) headers['X-API-Key'] = apiKey;
      const r = await fetch(url, {method:'POST', headers, body: JSON.stringify(body)});
      return r.json();
    }

    document.getElementById('save-instruction').addEventListener('click', async ()=>{
      const apiKey = document.getElementById('api_key').value.trim();
      const instruction = document.getElementById('instruction').value.trim();
      if (!apiKey) return alert('API Key required');
      if (!instruction) return alert('Instruction required');
      const res = await postJson('/resto-admin/system-instruction', apiKey, {instruction});
      document.getElementById('instr-out').textContent = JSON.stringify(res, null, 2);
    });

    document.getElementById('upload-menu').addEventListener('click', async ()=>{
      const apiKey = document.getElementById('api_key').value.trim();
      const menu_text = document.getElementById('menu_text').value.trim();
      if (!apiKey) return alert('API Key required');
      if (!menu_text) return alert('menu_text required');
      const res = await postJson('/resto-admin/menus', apiKey, {menu_text});
      document.getElementById('menu-out').textContent = JSON.stringify(res, null, 2);
    });
  </script>
</body>
</html>