{% extends 'base.html' %}

{% block title %}AI Training ‚Äî Resto Admin{% endblock %}

{% block head %}
<style>
    .ai-header {
        background: linear-gradient(135deg, #0b343d 0%, #0f4d5e 100%);
        color: white;
        padding: 30px;
        border-radius: 8px;
        margin-bottom: 30px;
    }
    .ai-header h2 {
        margin: 0 0 10px 0;
        font-size: 2rem;
    }
    .ai-header p {
        margin: 0;
        opacity: 0.95;
    }
    
    .upload-section {
        background: white;
        border: 2px dashed #0b343d;
        border-radius: 8px;
        padding: 40px;
        text-align: center;
        transition: all 0.3s ease;
        cursor: pointer;
    }
    .upload-section:hover {
        border-color: #0f4d5e;
        background-color: #f8f9ff;
    }
    .upload-section.dragover {
        border-color: #ffd41d;
        background-color: rgba(255, 212, 29, 0.05);
    }
    
    .upload-icon {
        font-size: 3rem;
        margin-bottom: 15px;
    }
    
    .file-input-wrapper {
        position: relative;
        overflow: hidden;
        display: inline-block;
    }
    .file-input-wrapper input[type=file] {
        position: absolute;
        left: -9999px;
    }
    
    .training-file-item {
        background: white;
        border: 1px solid #eee;
        border-radius: 6px;
        padding: 15px;
        margin-bottom: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: all 0.3s ease;
    }
    .training-file-item:hover {
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .file-info {
        flex: 1;
    }
    .file-name {
        font-weight: 600;
        color: #0b343d;
        margin-bottom: 5px;
    }
    .file-meta {
        font-size: 0.85rem;
        color: #999;
    }
    
    .training-status {
        display: inline-block;
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 600;
        margin-right: 10px;
    }
    .status-ready {
        background: #e8f5e9;
        color: #2e7d32;
    }
    .status-training {
        background: #fff3e0;
        color: #e65100;
    }
    .status-complete {
        background: #e3f2fd;
        color: #1565c0;
    }
    
    .info-box {
        background: #f0f4ff;
        border-left: 4px solid #667eea;
        padding: 20px;
        border-radius: 6px;
        margin-bottom: 30px;
    }
    .info-box h5 {
        color: #667eea;
        margin-top: 0;
    }
    .info-box ul {
        margin: 10px 0 0 0;
        padding-left: 20px;
    }
    .info-box li {
        margin-bottom: 8px;
        color: #333;
    }
    
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }
    .stat-card {
        background: white;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        text-align: center;
    }
    .stat-value {
        font-size: 2rem;
        font-weight: bold;
        color: #667eea;
        margin-bottom: 5px;
    }
    .stat-label {
        color: #666;
        font-size: 0.9rem;
    }
    
    .code-example {
        background: #1e1e1e;
        color: #d4d4d4;
        padding: 15px;
        border-radius: 6px;
        overflow-x: auto;
        font-family: 'Courier New', monospace;
        font-size: 0.85rem;
        margin: 10px 0;
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="ai-header">
        <h2>AI Training Data Management</h2>
        <p>Upload training files and knowledge bases to enhance your AI agent's responses</p>
    </div>

    <div class="row mb-4">
        <div class="col-md-8">
            <div class="card-surface mb-4">
                <h5 class="mb-4">Upload Training Files</h5>
                
                <div class="upload-section" id="uploadZone">
                    <div class="upload-icon">üìÅ</div>
                    <h5>Drag & Drop Files Here</h5>
                    <p style="color:#666; margin-bottom:20px;">or click to browse your computer</p>
                    <div class="file-input-wrapper">
                        <button class="btn btn-primary" style="background:#667eea; border:none;">Choose Files</button>
                        <input type="file" id="trainingFiles" multiple accept=".txt,.pdf,.docx,.json,.csv">
                    </div>
                    <p style="color:#999; font-size:0.85rem; margin-top:20px;">Supported formats: TXT, PDF, DOCX, JSON, CSV</p>
                </div>

                <div id="uploadProgress" style="display:none; margin-top:20px;">
                    <div class="progress">
                        <div class="progress-bar" id="progressBar" role="progressbar" style="width:0%"></div>
                    </div>
                    <small class="text-muted">Uploading... <span id="progressText">0%</span></small>
                </div>
            </div>

            <div class="card-surface">
                <h5 class="mb-4">Uploaded Training Files</h5>
                
                <div id="filesList">
                    <div class="training-file-item">
                        <div class="file-info">
                            <div class="file-name">üìÑ restaurant-menu.json</div>
                            <div class="file-meta">Uploaded 2 days ago ‚Ä¢ 245 KB ‚Ä¢ Active</div>
                        </div>
                        <div style="display:flex; align-items:center; gap:10px;">
                            <span class="training-status status-complete">Trained</span>
                            <button class="btn btn-sm btn-outline-danger">Remove</button>
                        </div>
                    </div>

                    <div class="training-file-item">
                        <div class="file-info">
                            <div class="file-name">üìÑ faq-responses.txt</div>
                            <div class="file-meta">Uploaded 5 days ago ‚Ä¢ 128 KB ‚Ä¢ Active</div>
                        </div>
                        <div style="display:flex; align-items:center; gap:10px;">
                            <span class="training-status status-complete">Trained</span>
                            <button class="btn btn-sm btn-outline-danger">Remove</button>
                        </div>
                    </div>

                    <div class="training-file-item">
                        <div class="file-info">
                            <div class="file-name">üìÑ customer-support.pdf</div>
                            <div class="file-meta">Uploaded today ‚Ä¢ 512 KB ‚Ä¢ Processing</div>
                        </div>
                        <div style="display:flex; align-items:center; gap:10px;">
                            <span class="training-status status-training">Training</span>
                            <button class="btn btn-sm btn-outline-secondary" disabled>Remove</button>
                        </div>
                    </div>
                </div>

                <div style="margin-top:20px; padding-top:20px; border-top:1px solid #eee;">
                    <button class="btn btn-secondary" style="background:#667eea; border:none; margin-right:10px;">Retrain All Models</button>
                    <button class="btn btn-outline-secondary">Export Training Data</button>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value">3</div>
                    <div class="stat-label">Files Uploaded</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">885 KB</div>
                    <div class="stat-label">Total Size</div>
                </div>
            </div>

            <div class="info-box">
                <h5>Training File Guidelines</h5>
                <ul>
                    <li><strong>TXT Files:</strong> Plain text data, Q&A pairs, or knowledge base</li>
                    <li><strong>JSON Files:</strong> Structured data with menu items, FAQs, or responses</li>
                    <li><strong>CSV Files:</strong> Tabular data like inventory, pricing, hours</li>
                    <li><strong>PDF/DOCX:</strong> Documents with training content</li>
                </ul>
            </div>

            <div class="info-box" style="border-left-color:#ff6b6b;">
                <h5 style="color:#ff6b6b;">Best Practices</h5>
                <ul style="margin-bottom:0;">
                    <li>Use clear, consistent formatting</li>
                    <li>Include context for Q&A pairs</li>
                    <li>Update files regularly</li>
                    <li>Keep file sizes under 50MB</li>
                    <li>Avoid duplicate content</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="card-surface mb-4">
        <h5 class="mb-3">Example Training File Formats</h5>
        
        <div class="row">
            <div class="col-md-6">
                <h6>JSON Format (Recommended)</h6>
                <div class="code-example">{
  "restaurant": {
    "name": "Resto",
    "menu": [
      {
        "item": "Margherita Pizza",
        "price": "$12.99",
        "description": "Fresh tomato and basil"
      }
    ]
  }
}</div>
            </div>
            <div class="col-md-6">
                <h6>Q&A Format (TXT)</h6>
                <div class="code-example">Q: What are your hours?
A: We're open 10am-10pm daily

Q: Do you deliver?
A: Yes, delivery available within 5 miles

Q: Any vegetarian options?
A: Yes, check our full menu for marked items</div>
            </div>
        </div>
    </div>

    <div class="card-surface">
        <h5 class="mb-3">Training Status & History</h5>
        <table class="table mb-0">
            <thead style="background:#f8f9fa;">
                <tr>
                    <th>Date</th>
                    <th>Action</th>
                    <th>Status</th>
                    <th>Duration</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Jan 27, 2026</td>
                    <td>File upload: customer-support.pdf</td>
                    <td><span class="badge bg-warning">In Progress</span></td>
                    <td>2 min 30 sec</td>
                </tr>
                <tr>
                    <td>Jan 25, 2026</td>
                    <td>Retrain all models</td>
                    <td><span class="badge bg-success">Completed</span></td>
                    <td>5 min 12 sec</td>
                </tr>
                <tr>
                    <td>Jan 22, 2026</td>
                    <td>File upload: faq-responses.txt</td>
                    <td><span class="badge bg-success">Completed</span></td>
                    <td>1 min 45 sec</td>
                </tr>
                <tr>
                    <td>Jan 20, 2026</td>
                    <td>File upload: restaurant-menu.json</td>
                    <td><span class="badge bg-success">Completed</span></td>
                    <td>3 min 08 sec</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<script>
    const uploadZone = document.getElementById('uploadZone');
    const trainingFiles = document.getElementById('trainingFiles');

    // Drag and drop functionality
    uploadZone.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadZone.classList.add('dragover');
    });

    uploadZone.addEventListener('dragleave', () => {
        uploadZone.classList.remove('dragover');
    });

    uploadZone.addEventListener('drop', (e) => {
        e.preventDefault();
        uploadZone.classList.remove('dragover');
        trainingFiles.files = e.dataTransfer.files;
    });

    // Click to upload
    uploadZone.addEventListener('click', () => {
        trainingFiles.click();
    });
</script>
{% endblock %}
