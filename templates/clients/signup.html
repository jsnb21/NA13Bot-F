{% extends 'clients/auth_base.html' %}

{% block head %}
<style>
  .step-dot { height: 6px; flex: 1; margin: 0 4px; background: var(--input-border); border-radius: 10px; transition: 0.3s; }
  .step-dot.active { background: var(--brand-dark); }
  .form-step { display: none; }
  .form-step.active { display: block; animation: slideUp 0.4s ease; }
  @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
</style>
{% endblock %}

{% block content %}
<div class="auth-card">
    <div class="text-center mb-4">
      <h4 class="fw-bold" style="color: var(--brand-dark)">Create Account</h4>
      <p class="text-secondary small" id="step-text">Step 1: Account Security</p>
      {% if error %}
      <div class="alert alert-danger mt-2">{{ error }}</div>
      {% endif %}
    </div>

    <div class="d-flex mb-4">
      <div class="step-dot active" id="dot-1"></div>
      <div class="step-dot" id="dot-2"></div>
      <div class="step-dot" id="dot-3"></div>
    </div>

    <form method="POST" action="/signup" enctype="multipart/form-data">
      <div class="form-step active" id="step-1">
        <div class="mb-3">
          <label class="form-label">Email Address</label>
          <input type="email" name="email" class="form-control" placeholder="admin@neuronet.ai" required>
        </div>
        <div class="row">
          <div class="col-md-6 mb-3">
            <label class="form-label">Password</label>
            <input type="password" name="password" class="form-control" placeholder="••••••••">
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label">Confirm</label>
            <input type="password" name="confirm_password" class="form-control" placeholder="••••••••">
          </div>
        </div>
        <button type="button" class="btn w-100 mt-3 py-3 text-white fw-bold" style="background: var(--brand-dark); border-radius:12px;" onclick="nextStep(2)">
          Continue <i class="fa-solid fa-arrow-right ms-2"></i>
        </button>
      </div>

      <div class="form-step" id="step-2">
        <div class="mb-3">
          <label class="form-label">Restaurant Name</label>
          <input type="text" name="establishment_name" class="form-control" placeholder="The Golden Bistro">
        </div>
        <div class="mb-4">
          <label class="form-label">Logo Upload</label>
          <input type="file" name="logo_file" class="form-control">
        </div>
        <div class="d-flex gap-2">
          <button type="button" class="btn btn-light flex-grow-1 py-3 fw-bold" onclick="nextStep(1)">Back</button>
          <button type="button" class="btn text-white flex-grow-1 py-3 fw-bold" style="background: var(--brand-dark)" onclick="nextStep(3)">Next</button>
        </div>
      </div>

      <div class="form-step" id="step-3">
        <div class="row mb-4">
          <div class="col-6">
            <label class="form-label">Brand Color</label>
            <input type="color" name="main_color" class="form-control w-100 p-1" style="height: 50px;" value="#0b343d">
          </div>
          <div class="col-6">
            <label class="form-label">Accent Color</label>
            <input type="color" name="sub_color" class="form-control w-100 p-1" style="height: 50px;" value="#ffc832">
          </div>
        </div>
        <button type="submit" class="btn w-100 py-3 text-white fw-bold" style="background: var(--brand-dark); border-radius:12px;">
          Complete Setup
        </button>
      </div>
    </form>
</div>
{% endblock %}

{% block scripts %}
<script>
  function nextStep(step) {
    document.querySelectorAll('.form-step').forEach(el => el.classList.remove('active'));
    document.querySelectorAll('.step-dot').forEach(el => el.classList.remove('active'));
    document.getElementById('step-' + step).classList.add('active');
    for(let i=1; i<=step; i++) document.getElementById('dot-' + i).classList.add('active');
    
    const titles = ["Account Security", "Restaurant Branding", "Final Details"];
    document.getElementById('step-text').innerText = "Step " + step + ": " + titles[step-1];
  }
</script>
{% endblock %}